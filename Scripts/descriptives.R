#-----------------------------------------------------------------------------#
#
# Author:        Logan Stundal
# Date:          September 17, 2021
# Purpose:       Descriptive statistics
#   - For APSA 2021
#
# Copyright (c): Logan Stundal, 2021
# Email:         stund005@umn.edu
#
#-----------------------------------------------------------------------------#
#
# Notes:
#
#
#-----------------------------------------------------------------------------#



#-----------------------------------------------------------------------------#
# ADMINISTRATIVE                                                          ----
#-----------------------------------------------------------------------------#
#---------------------------#
# Clear working environment
#---------------------------#
rm(list = ls())
#---------------------------#

#---------------------------#
# Load required packages
#---------------------------#
library(tidyverse)
library(kableExtra)
#---------------------------#

#---------------------------#
# Load data
#---------------------------#
load("Data/HealthDiplomacy.Rdata")
#---------------------------#
#-----------------------------------------------------------------------------#



#-----------------------------------------------------------------------------#
# DATA ADMIN                                                              ----
#-----------------------------------------------------------------------------#
d   <- d %>%
  filter(!cname %in% c("United States", "China"),
         !year  %in% c(as.character(2000:2002))) %>%
  arrange(year, ccode)
#-----------------------------------------------------------------------------#



#-----------------------------------------------------------------------------#
# DESCRIPTIVE STATISTICS                                                  ----
#-----------------------------------------------------------------------------#
# ----------------------------------- #
# Summary statistics
# ----------------------------------- #
desc <- d %>%
  st_drop_geometry() %>%
  select(dah_per_usa, dah_per_chn,
         vdem,
         exports_ln, imports_ln, pop_ln,
         life_expec_ln, daly_ncd_percent, daly_cd_percent) %>%
  summarize(across(.cols = everything(),
                   .fns  = list("Mean" = mean,
                                "SD"   = sd,
                                "Min" = min,
                                "Max" = max),
                   .names= "{.col}.{.fn}")) %>%
  pivot_longer(.,
               cols      = everything(),
               names_to  = c("variable", "stat"),
               names_sep = "[.]",
               values_to = "val") %>%
  pivot_wider(.,
              id_cols     = "variable",
              names_from  = "stat",
              values_from = "val")
# ----------------------------------- #


# ----------------------------------- #
# Descriptive statistics table
# ----------------------------------- #
kbl(x         = desc,
    col.names = c("", colnames(desc)[2:5]),
    format    = "pipe",
    digits    = 2) %>%
  save_kable(.,
             file = "Results/Tables/descriptive-statistics.txt")
# ----------------------------------- #
#-----------------------------------------------------------------------------#



#-----------------------------------------------------------------------------#
# SAVE                                                                    ----
#-----------------------------------------------------------------------------#
#save.image()
#rm(list = ls())
#-----------------------------------------------------------------------------#
